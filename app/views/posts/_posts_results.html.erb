<% @posts.each_with_index do |post, index| %>
  <% if (Time.now.strftime("%Y-%d-%m") < post.data.strftime("%Y-%d-%m")) %>
      <% if index.even? %>
        <ul class="cards">
      <% end %> 
      <li class='card'>
      <div class='card_image'>
        <%= image_tag "guida4.jpg"%> <!-- mettere l'immagine corretta -->
      </div>
      <h3 class='card-title'>
          <%= post.titolo %> <br> 
      </h3>
      <div class='card-content'>
          <p>
              <%= post.descrizione%>
          </p>
          <hr> 
          <h4 style='font-size: 15px'>Citt√†: <%= post.nomeC %> <br/></h4>
          </div>
          
          <div class='card-languages'>
              <h4>
                  Lingua: <span style='font-weight: normal;'><%= post.lingua %></span> <br />
                  Data e ora: <span style='font-weight: normal'><%= post.instance_variable_get(:@data) %> <%= post.instance_variable_get(:@ora) %></span>
              </h4>
          </div>
          <div class='card-link-wrapper'> 
              <%@guide_user = User.where(email: post.user_email)%>
              <%@room_id = Participant.where(user_id: current_user.id).or(Participant.where(user_id: @guide_user)).group(:room_id).having("COUNT(*)=2").pluck(:room_id)%>
              <%@single_room = Room.find_or_create_by(id: @room_id.first)%>
              <%= link_to 'Chatta', room_path(@single_room), class: "card-link"%>
              <%= link_to post.instance_variable_get(:@total_price), post_path(post), class: "card-link" %>
          </div>
          </li> 
            <% if index.odd? || index == @posts.size - 1 %>
      </ul>
      <% end %>
    <% end %>

<% end %>
